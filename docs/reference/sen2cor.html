<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Correct L1C products using Sen2Cor — sen2cor • sen2r</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Correct L1C products using Sen2Cor — sen2cor" />
<meta property="og:description" content="The function uses Sen2Cor to manually correct L1C products.
Standalone version of
sen2cor
(version 2.8.0 or 2.5.5) is used." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sen2r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code"></span>
     
     Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/docker.html">Run in a Docker container</a>
    </li>
    <li>
      <a href="../articles/sen2r_gui.html">Using sen2r() from the GUI</a>
    </li>
    <li>
      <a href="../articles/sen2r_cmd.html">Using sen2r() from the command line</a>
    </li>
    <li>
      <a href="../articles/outstructure.html">Output file structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper"></span>
     
     Changelog
  </a>
</li>
<li>
  <a href="http://luigi.ranghetti.info">
    <span class="fa fa-user"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ranghetti/sen2r/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Correct L1C products using Sen2Cor</h1>
    <small class="dont-index">Source: <a href='https://github.com/ranghetti/sen2r/blob/master/R/sen2cor.R'><code>R/sen2cor.R</code></a></small>
    <div class="hidden name"><code>sen2cor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function uses Sen2Cor to manually correct L1C products.
Standalone version of
<a href='http://step.esa.int/main/third-party-plugins-2/sen2cor'>sen2cor</a>
(version 2.8.0 or 2.5.5) is used.</p>
    </div>

    <pre class="usage"><span class='fu'>sen2cor</span>(
  <span class='kw'>l1c_prodlist</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>l1c_dir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>outdir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>proc_dir</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>tmpdir</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>rmtmp</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>gipp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>use_dem</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>tiles</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>timeout</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>kill_errored</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>.log_message</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>.log_output</span> <span class='kw'>=</span> <span class='fl'>NA</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>l1c_prodlist</th>
      <td><p>List of L1C product names to be corrected. They can be both
product names with full/relative path or only names of SAFE products (in this case, also
l1c_dir argument must be provided). SAFE products must be unzipped.
Note that, at this stage, all products must be in the same directory (this will be fixed).</p></td>
    </tr>
    <tr>
      <th>l1c_dir</th>
      <td><p>Full or relative path of input L1C products.
If NULL (default), <code>l1c_prodlist</code> must already be a vector of full paths.</p></td>
    </tr>
    <tr>
      <th>outdir</th>
      <td><p>Directory where output L2A products will be placed.
If NULL (default), each product is left in the parent directory of <code>l1c_prodlist</code>.</p></td>
    </tr>
    <tr>
      <th>proc_dir</th>
      <td><p>(optional) Directory where processing is applied.
If NA (default), processing is done in <code>l1c_dir</code> and output L2A product is
then moved to <code>outdir</code>, unless <code>l1c_dir</code> is a subdirectory of a SAMBA mountpoint under Linux:
in this case, L1C input products are copied in a temporary directory
(specified with argument <code>tmpdir</code>),
processing is done there and then L2A is moved to <code>outdir</code>.
This is required under Linux systems when <code>l1c_dir</code> is a subdirectory of
a unit mounted with SAMBA, otherwise Sen2Cor would produce empty L2A products.</p></td>
    </tr>
    <tr>
      <th>tmpdir</th>
      <td><p>(optional) Path where processing is performed if a temporary
working directory is required (see argument <code>proc_dir</code>). Be sure <code>tmpdir</code>
not to be a SAMBA mountpoint under Linux.
Default is a temporary directory.
If <code>tmpdir</code> is a non-empty folder, a random subdirectory will be used.</p></td>
    </tr>
    <tr>
      <th>rmtmp</th>
      <td><p>(optional) Logical: should temporary files be removed?
(Default: TRUE)</p></td>
    </tr>
    <tr>
      <th>gipp</th>
      <td><p>(optional) Ground Image Processing Parameters (GIPP)
to be passed to Sen2Cor.
It is possible to specify both the path of an existing XML file
or a list of parameters in the form <code>parameter_name = "value"</code>, where
<code>parameter_name</code> is the name of the parameter as specified in the
XML file (case insensitive), and <code>"value"</code> is the character value
which the user wants to set
(notice that, in the case the user wants to specify the value <code>NONE</code>,
both <code>"NONE"</code> and <code>NA</code> can be used, but not <code>NULL</code>, which has the effect
to maintain the value specified in the XML file).</p>
<p>For details about the GIPP parameters, refer to the Sen2Cor documentation
(v. <a href='http://step.esa.int/main/third-party-plugins-2/sen2cor/sen2cor_v2-5-5/'>2.5.5</a>
or <a href='http://step.esa.int/main/third-party-plugins-2/sen2cor/sen2cor_v2-8/'>2.8.0</a>:
see the "Schemas of the GIPP file" at the end of each page).
<em>Note</em>: this argument takes effect only in the current execution of
<code>sen2cor()</code> function.</p></td>
    </tr>
    <tr>
      <th>use_dem</th>
      <td><p>(optional) Logical:
if TRUE, Sen2Cor is set to use a Digital Elevation Model for topographic
correction (reflecting what is done for Level-2A SAFE images provided by ESA Hub);
if FALSE, it is set not to perform topographic correction (reflecting the
current default Sen2Cor behaviour);
if NA (default), the option set in the XML GIPP configuration file
used by sen2r (stored in the default sen2r settings directory) is respected;
in case the user never edited it,
the current default setting is not to perform topographic correction.</p>
<p><em>Notes</em>:</p><ol>
<li><p>if TRUE, the path used to read or store DEM files
and the online source used to download missing DEM tiles
are respectively the <code>DEM_Directory</code> and <code>DEM_Reference</code> parameters
set in the default sen2r GIPP XML file (the user can read them
with the function <code><a href='gipp.html'>read_gipp(c("DEM_Directory", "DEM_Reference"))</a></code>).
In case one or both these parameters were set to <code>"NONE"</code>,
a subdirectory <code>"srtm90"</code> of the default sen2r directory is used as
DEM directory, and/or the <a href='http://srtm.csi.cgiar.org/'>CGIAR SRTM 90m</a>
is set as online source.
To set another directory or reference, use argument <code>gipp</code> in the form
<code>gipp = list(DEM_Directory = tempdir(), DEM_Reference ="another_reference", ...)</code>
(replacing <code><a href='https://rdrr.io/r/base/tempfile.html'>tempdir()</a></code> with the desired path and specifying the online resource).</p></li>
<li><p>Currently the default value is NA in order to grant backward
compatibility. In a future release of sen2r, the default value will be
set to TRUE, so to grant homogeneity between Level-2A products downloaded
from ESA Hub and generated using Sen2Cor.</p></li>
</ol></td>
    </tr>
    <tr>
      <th>tiles</th>
      <td><p>Vector of Sentinel-2 Tile strings (5-length character) to be
processed (default: process all the tiles found in the input L1C products).</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>(optional) Logical: if TRUE, Sen2Cor instances are launched
in parallel using multiple cores; if FALSE (default), they are launched in
series on a single core.
The number of cores is automatically determined; specifying it is also
possible (e.g. <code>parallel = 4</code>).</p></td>
    </tr>
    <tr>
      <th>timeout</th>
      <td><p>Integer value: number of minutes after which killing Sen2Cor
if it is still running (default, 0, means that this is never done).
This can be useful in case Sen2Cor produced an error without exiting
from Python (leaving a standing process running).</p></td>
    </tr>
    <tr>
      <th>kill_errored</th>
      <td><p>Logical: experimental feature allowing killing dead Sen2Cor
processes, so leaving <code>sen2cor()</code> continuing processing on the remaining
products. Set to TRUE to activate it (default is FALSE).
This experimental feature is available only on Unix systems,
and requires package "tools" to be installed.
This option is not compatible with <code>timeout</code> (in case both are set,
<code>kill_errored</code> will be ignored).</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>Logical value: should existing output L2A products be overwritten?
(default: FALSE)</p></td>
    </tr>
    <tr>
      <th>.log_message</th>
      <td><p>(optional) Internal parameter
(it is used when the function is called by <code><a href='sen2r.html'>sen2r()</a></code>).</p></td>
    </tr>
    <tr>
      <th>.log_output</th>
      <td><p>(optional) Internal parameter
(it is used when the function is called by <code><a href='sen2r.html'>sen2r()</a></code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Vector character with the list ot the output products
(being corrected or already existing).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>License: GPL 3.0</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>L. Ranghetti, M. Boschetti, F. Nutini, L. Busetto (2020).
"sen2r": An R toolbox for automatically downloading and preprocessing
Sentinel-2 satellite data. <em>Computers &amp; Geosciences</em>, 139, 104473. DOI:
<a href='https://doi.org/10.1016/j.cageo.2020.104473'>10.1016/j.cageo.2020.104473</a>,
URL: <a href='http://sen2r.ranghetti.info/'>http://sen2r.ranghetti.info/</a>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Download an L1C SAFE product</span>
<span class='no'>example_s2_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='s2_list.html'>s2_list</a></span>(
  <span class='kw'>spatial_extent</span> <span class='kw'>=</span> <span class='fu'>st_sfc</span>(<span class='fu'>st_point</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>12.0</span>, <span class='fl'>44.8</span>)), <span class='kw'>crs</span><span class='kw'>=</span><span class='fu'>st_crs</span>(<span class='fl'>4326</span>)),
  <span class='kw'>tile</span> <span class='kw'>=</span> <span class='st'>"32TQQ"</span>,
  <span class='kw'>time_interval</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"2017-05-01"</span>,<span class='st'>"2017-07-30"</span>))
)
<span class='fu'><a href='s2_download.html'>s2_download</a></span>(<span class='no'>example_s2_list</span>, <span class='kw'>outdir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>())

<span class='co'># Correct it applying a topographic correction</span>
<span class='fu'>sen2cor</span>(
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>example_s2_list</span>)[<span class='fl'>1</span>],
  <span class='kw'>l1c_dir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(),
  <span class='kw'>outdir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(),
  <span class='kw'>use_dem</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Luigi Ranghetti, Lorenzo Busetto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


